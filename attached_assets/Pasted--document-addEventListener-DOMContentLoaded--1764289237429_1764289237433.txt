// ... (ріе document.addEventListener('DOMContentLoaded', ...) рЅарЇірЅх рІГрїерѕЮрѕЕ)

// ­ЪџЕ ріарІ▓рѕх рЅ░рїЇрЅБрѕГрЇА ріеріГрѕЮрЅйрЅх рЅ│рѕхріГ рѕўрІЇрѕ░рІх (Backend рїЦрІФрЅёріЋ рѕЏрѕхрѕўрѕ░рѕЇ)
function setupTaskAssignmentListener() {
    const getTaskButton = document.getElementById('getNewTaskButton');
    const activeTaskArea = document.getElementById('activeTaskArea');
    const submissionArea = document.getElementById('submissionArea');

    if (getTaskButton) {
        getTaskButton.addEventListener('click', () => {
            
            // рІерЅ┤рѕїрїЇрѕФрѕЮ рѕўрїФріЏріЋ ріЦріЊрѕ│рІГ
            window.Telegram.WebApp.showProgress('ріарІ▓рѕх рЅ│рѕхріГ ріЦрІерЇѕрѕѕрїѕ ріљрІЇ...');

            // рІеBackend рїЦрІФрЅёріЋ рЅа 2 рѕ░ріеріЋрІх ріЦріЊрѕхрѕўрѕхрѕІрѕѕріЋ
            setTimeout(() => {
                window.Telegram.WebApp.hideProgress();

                // ­ЪћЉ ріЦрІџрѕЁ рѕІрІГ ріљрІЇ рІѕрІ░ ріЦрІЇріљрЅ░ріЏрІЇ Backend API рїЦрІФрЅё рІерѕџрѕІріерІЇ (рѕѕрѕЮрѕ│рѕї: fetch('/api/get-task'))

                // рѕѕрѕЎріерѕФрЇБ рѕЮріЊрЅБрІі ріаріФрІЇріЋрЅх ріЦріЋрЇѕрїЦрѕФрѕѕріЋ
                const assignedEmail = `new.task.${Math.floor(Math.random() * 1000)}@gmail.com`;
                const assignedPassword = 'DefaultPassword123';

                activeTaskArea.innerHTML = `
                    <div class="card assigned-task-box">
                        <h3 style="color: var(--primary-color);">рЅ░рїЇрЅБрѕГ рЅ░рѕ░рїЦрЅХрІјрЅ│рѕЇ!</h3>
                        <p>рІГрѕЁріЋріЋ рѕўрѕерїЃ рЅ░рїарЅЁрѕўрІЇ ріарІ▓рѕх ріаріФрІЇріЋрЅх рІГріГрЇѕрЅ▒:</p>
                        <ul class="task-details">
                            <li><strong>рібрѕюрІГрѕЇ:</strong> <span class="email-text">${assignedEmail}</span></li>
                            <li><strong>рІерІГрѕѕрЇЇ рЅЃрѕЇ:</strong> <span class="password-text">${assignedPassword}</span></li>
                        </ul>
                        <p style="color: var(--accent-color); font-size: 14px; margin-top: 10px;">рІГрѕЁріЋріЋ ріаріФрІЇріЋрЅх рЅарѕўріГрЇѕрЅх рІерѕЏрѕхрѕеріерЅбрІФ рЅЁрї╣ріЋ рІГрїарЅђрѕЎрЇб</p>
                    </div>
                `;
                
                // рІерѕЏрѕхрѕеріерЅбрІФ рЅЁрї╣ріЋ ріЦріЊрѕ│рІГ
                submissionArea.style.display = 'block';
            
            }, 2000); // 2 рѕ░ріеріЋрІх рІГрїарЅЦрЅЃрѕЇ
        });
    }
}

// ... (ріерІџрѕЁ рЅарЅ│рЅй рІФрѕѕрІЇріЋ рІеDOMContentLoaded listener ріЦріЊрѕхрЅ░ріФріГрѕІрѕѕріЋ)

document.addEventListener('DOMContentLoaded', () => {
    initTelegramApp();
    
    // рІеріћрЅфрїїрѕйріЋ ріарІЮрѕФрѕГ ріГрѕіріГ рЅ░рЅєрїБрїБрѕф
    const navButtons = document.querySelectorAll('.bottom-nav .nav-item');
    navButtons.forEach(button => {
        button.addEventListener('click', () => {
            const page = button.getAttribute('data-page');
            renderPage(page);
        });
    });

    // рѕўрїђрѕўрѕфрІФ рѕІрІГ рІеTasks рїѕрїйріЋ ріарѕ│рІГ
    renderPage('tasks');
    
    // ­ЪџЕ ріарІ▓рѕхрЇА ріарІ▓рѕх рІерЅ│рѕхріГ рѕўрІЇрѕ░рїЃ listener ріЦріЋрїерѕЮрѕФрѕѕріЋ
    setupTaskAssignmentListener(); 
});