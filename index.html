<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G-Task Manager ğŸ‡ªğŸ‡¹</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="app-container">
        
        <header class="top-header">
            <h1 class="app-title" id="appTitle">G-Task Manager</h1>
            <div id="userBalance" class="balance-display">
                <span class="balance-amount">0.00 ETB</span>
            </div>
        </header>

        <main class="content-area" id="contentArea">
            </main>

        <nav class="bottom-nav" id="bottomNav">
            <button class="nav-item active" data-page="tasks">âœ… á‰°áŒá‰£áˆ«á‰µ</button>
            <button class="nav-item" data-page="balance">ğŸ’° áˆ‚áˆ³á‰¥</button>
            <button class="nav-item" data-page="withdraw">ğŸ’³ áˆ›á‹áŒ«</button>
        </nav>
    </div>

    <div id="adminModalOverlay" class="admin-modal-overlay" style="display: none;">
        <div class="admin-modal">
            <h2>ğŸ” Admin Panel</h2>
            <div class="admin-login-form" id="adminLoginForm" style="display: none;">
                <input type="password" id="adminPassword" placeholder="Admin Password" class="form-input">
                <button class="primary-button" id="adminLoginBtn">áŒá‰£</button>
            </div>
            <div class="admin-panel" id="adminPanel" style="display: none;">
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="credentials">ğŸ”‘ Credentials</button>
                    <button class="admin-tab" data-tab="pending">â³ Pending Tasks</button>
                </div>

                <div class="admin-tab-content" id="credentialsTab" style="display: block;">
                    <h3>Gmail Credentials Pool</h3>
                    <div id="saveStatus" class="save-status" style="display: none;">âœ… á‰°á‰€áˆáŒ á‹‹áˆ</div>
                    <div class="admin-form">
                        <input type="email" id="adminEmail" placeholder="Gmail Address" class="form-input">
                        <input type="text" id="adminGmailPassword" placeholder="Password" class="form-input">
                        <input type="email" id="adminRecoveryEmail" placeholder="Recovery Email" class="form-input">
                        <button class="primary-button" id="addCredentialBtn">âœ… áŒ¨áˆáˆ­</button>
                        <button class="primary-button" id="exportBtn" style="background-color: #FF9800; margin-top: 10px;">ğŸ“¥ á‹ˆáˆ¨á‹ˆáˆ­</button>
                    </div>
                    <div class="credentials-list">
                        <h4>Credentials Pool:</h4>
                        <div id="credentialsList"></div>
                    </div>
                </div>

                <div class="admin-tab-content" id="pendingTab" style="display: none;">
                    <h3>â³ Pending Tasks</h3>
                    <div id="pendingTasksList"></div>
                </div>

                <button class="primary-button accent-bg" id="adminLogoutBtn" style="margin-top: 15px;">á‹áŒ£</button>
            </div>
            <button class="close-modal-btn" id="closeAdminModal" style="position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 24px; cursor: pointer;">âœ•</button>
        </div>
    </div>

    <script>
        // ğŸš© á‹ˆáˆ³áŠá¡ á‹¨á‰´áˆŒáŒáˆ«áˆ SDK áˆ›áˆµáŒ€áˆ˜áˆªá‹«
        function initTelegramApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
                // á‹¨á‰´áˆŒáŒáˆ«áˆ áŒˆáŒ½á‰³ á‰€áˆˆáˆáŠ• áŠ¨áŠ¢á‰µá‹®áŒµá‹«á‹Šá‹ á‹³áˆ« áŒ‹áˆ­ áˆˆáˆ›áˆ˜áˆ³áˆ°áˆ
                const bgColor = '#F5F5F5'; 
                window.Telegram.WebApp.setBackgroundColor(bgColor);
            }
        }
        
        // áŒˆáŒ¾á‰½áŠ• á‹¨áˆšá‰€á‹­áˆ­ á‰°áŒá‰£áˆ­ (á‰ Vanilla JS)
        function renderPage(pageName) {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = ''; // á‹«áˆˆá‹áŠ• á‹­á‹˜á‰µ á‰£á‹¶ áˆ›á‹µáˆ¨áŒ

            const navItems = document.querySelectorAll('.bottom-nav .nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            document.querySelector(`.nav-item[data-page="${pageName}"]`).classList.add('active');

            let contentHTML = '';

            if (pageName === 'tasks') {
                contentHTML = `
                    <div id="activeTaskArea"></div>
                    <div class="card task-card accent-border">
                        <h2>âœ… á‹¨áŒ‚áˆœáˆ áŠ áŠ«á‹áŠ•á‰µ áˆ˜áŠ­áˆá‰µ</h2>
                        <p>áŠ á‹²áˆµ á‹¨áŒ‚áˆœáˆ áŠ áŠ«á‹áŠ•á‰µ áŠ¨áá‰°á‹ á‰ á‰°áŒ á‰€áˆ±á‰µ áˆ˜áˆµáˆáˆ­á‰¶á‰½ áˆ˜áˆ áˆ¨á‰µ á‹«áˆµáˆ¨áŠ­á‰¡á¢ áˆˆáŠ¥á‹«áŠ•á‹³áŠ•á‹± á‰°á‰€á‰£á‹­áŠá‰µ áˆ‹áŒˆáŠ˜ áŠ áŠ«á‹áŠ•á‰µ **5.00 ETB** á‹«áŒˆáŠ›áˆ‰á¢</p>
                        <div class="instructions">
                            <h3>áˆ˜áˆ˜áˆªá‹«á‹á‰½:</h3>
                            <ul>
                                <li>1. áŠ áŠ«á‹áŠ•á‰±áŠ• áˆˆáˆ˜áŠ­áˆá‰µ áŠ á‹áˆ«áˆ©áŠ• á‹­áŒ«áŠ‘á¢</li>
                                <li>2. áŠ áŠ«á‹áŠ•á‰± áŠ¨á‰°áŠ¨áˆá‰° á‰ áŠ‹áˆ‹ "áŠ áˆµáˆ¨áŠ­á‰¥" á‹¨áˆšáˆˆá‹áŠ• á‹­áŒ«áŠ‘áŠ“ áŠ¢áˆœá‹­áˆ‰áŠ•/á‹¨á‹­áˆˆá á‰ƒáˆ‰áŠ• á‹­áˆ‹áŠ©á¢</li>
                                <li>3. áˆ›áˆ¨áŒ‹áŒˆáŒ« áŠ¥áˆµáŠªáŒ áŠ“á‰€á‰… á‹­áŒ á‰¥á‰á¢</li>
                            </ul>
                        </div>
                        <button class="primary-button" id="getNewTaskButton">áŒ‚áˆœáˆ áŠ áŠ«á‹áŠ•á‰µ á‹­áŠ­áˆá‰±</button>
                    </div>
                    <div id="submissionArea" style="display: none;"></div>
                `;
            } else if (pageName === 'balance') {
                 contentHTML = `
                    <div class="card">
                        <h2>ğŸ’° á‹¨áŠ¥áˆ­áˆµá‹ áˆ‚áˆ³á‰¥</h2>
                        <div class="balance-large">
                            <strong>125.00</strong> <small>ETB</small>
                        </div>
                        <p class="history-title">á‹¨á‰…áˆ­á‰¥ áŒŠá‹œ áŠ¥áŠ•á‰…áˆµá‰ƒáˆ´á‹á‰½:</p>
                        <ul class="history-list">
                            <li>+5.00 ETB (Task #123) - á‹›áˆ¬</li>
                            <li>-50.00 ETB (á‹ˆáŒª) - á‰µáŠ“áŠ•á‰µ</li>
                            <li>+10.00 ETB (Task #125) - áŠ¨á‰µáŠ“áŠ•á‰µ á‹ˆá‹²á‹«</li>
                        </ul>
                    </div>
                 `;
            } else if (pageName === 'withdraw') {
                 contentHTML = `
                    <div class="card">
                        <h2>ğŸ’³ áŒˆáŠ•á‹˜á‰¥ áˆ›á‹áŒ«</h2>
                        <p>áŒˆáŠ•á‹˜á‰¥á‹áŠ• á‰ á‰´áˆŒ á‰¥áˆ­ á‹ˆá‹­áˆ á‰ á‰£áŠ•áŠ­ áŠ áŠ«á‹áŠ•á‰µ áˆ›á‹áŒ£á‰µ á‹­á‰½áˆ‹áˆ‰á¢ á‹á‰…á‰°áŠ›á‹ á‹¨áˆ›á‹áŒ« áŒˆá‹°á‰¥ **50.00 ETB** áŠá‹á¢</p>
                        <input type="number" placeholder="á‹¨áˆ›á‹áŒ£á‰µ áˆ˜áŒ áŠ• á‹«áˆµáŒˆá‰¡ (áˆˆáˆáˆ³áˆŒ 50)">
                        <button class="primary-button accent-bg">áˆ›á‹áŒ£á‰µ á‹­áŒ á‹­á‰</button>
                    </div>
                 `;
            }
            contentArea.innerHTML = contentHTML;
        }

        // Admin State
        let isAdminLoggedIn = false;
        const ADMIN_PASSWORD = 'admin123';
        let currentUserIdForTask = null;

        // Gmail áˆ°áŠá‹µ áŠ­áˆá‰½á‰µ - áˆáˆ³áˆŒ áˆ°áŠá‹µ áˆˆáˆ™áŠ¨áˆ«
        function initializeSampleCredentials() {
            const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
            if (pool.length === 0) {
                const samples = [
                    { username: 'task.user.2024@gmail.com', password: 'SecurePass123', recovery: 'recovery.email@yahoo.com' },
                    { username: 'gmail.task.001@gmail.com', password: 'Password456', recovery: 'backup.email@outlook.com' },
                    { username: 'account.setup.001@gmail.com', password: 'TaskPass789', recovery: 'alternative@mail.com' }
                ];
                localStorage.setItem('gmailPool', JSON.stringify(samples));
            }
        }

        function getCredentialsFromPool() {
            const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
            if (pool.length === 0) {
                alert('âŒ áˆáŠ•áˆ áˆ°áŠá‹µ áŠ á‹­áŒˆáŠ™áˆ - admin áŠ­áˆá‰½á‰µ á‹­áˆ™áˆ‰');
                return null;
            }
            const randomIndex = Math.floor(Math.random() * pool.length);
            return pool[randomIndex];
        }

        // Admin Panel Functions
        function initAdminPanel() {
            const appTitle = document.getElementById('appTitle');
            let clickCount = 0;
            appTitle.addEventListener('click', () => {
                clickCount++;
                if (clickCount === 3) {
                    document.getElementById('adminModalOverlay').style.display = 'flex';
                    document.getElementById('adminLoginForm').style.display = 'block';
                    clickCount = 0;
                }
            });

            const adminLoginBtn = document.getElementById('adminLoginBtn');
            const adminPassword = document.getElementById('adminPassword');
            adminLoginBtn.addEventListener('click', () => {
                const enteredPassword = adminPassword.value.trim();
                if (enteredPassword === ADMIN_PASSWORD) {
                    isAdminLoggedIn = true;
                    document.getElementById('adminLoginForm').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    updateCredentialsList();
                } else {
                    alert('âŒ á‹ˆá‹° á‰°áˆ³áˆ³á‰° á“áˆµá‹ˆáˆ­á‹µ - admin123 á‹­áŒ á‰€áˆ™');
                    adminPassword.value = '';
                    adminPassword.focus();
                }
            });

            const addCredentialBtn = document.getElementById('addCredentialBtn');
            addCredentialBtn.addEventListener('click', () => {
                const email = document.getElementById('adminEmail').value.trim();
                const password = document.getElementById('adminGmailPassword').value.trim();
                const recovery = document.getElementById('adminRecoveryEmail').value.trim();

                if (!email || !password || !recovery) {
                    alert('âŒ áˆáˆ‰áŠ•áˆ áˆ˜áˆµáŠ®á‰½ á‹­áˆ™áˆ‰');
                    return;
                }

                const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
                pool.push({ username: email, password, recovery });
                localStorage.setItem('gmailPool', JSON.stringify(pool));

                document.getElementById('adminEmail').value = '';
                document.getElementById('adminGmailPassword').value = '';
                document.getElementById('adminRecoveryEmail').value = '';
                updateCredentialsList();
                showSaveStatus();
            });

            const exportBtn = document.getElementById('exportBtn');
            exportBtn.addEventListener('click', () => {
                const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
                const dataStr = JSON.stringify(pool, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'gmail-credentials-backup.json';
                link.click();
                URL.revokeObjectURL(url);
            });

            document.getElementById('adminLogoutBtn').addEventListener('click', () => {
                isAdminLoggedIn = false;
                document.getElementById('adminLoginForm').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminModalOverlay').style.display = 'none';
            });

            document.getElementById('closeAdminModal').addEventListener('click', () => {
                document.getElementById('adminModalOverlay').style.display = 'none';
                isAdminLoggedIn = false;
                document.getElementById('adminLoginForm').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
            });

            // Tab switching
            const adminTabs = document.querySelectorAll('.admin-tab');
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    adminTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    document.querySelectorAll('.admin-tab-content').forEach(content => {
                        content.style.display = 'none';
                    });
                    
                    if (tabName === 'credentials') {
                        document.getElementById('credentialsTab').style.display = 'block';
                    } else if (tabName === 'pending') {
                        document.getElementById('pendingTab').style.display = 'block';
                        updatePendingTasksList();
                    }
                });
            });
        }

        function updatePendingTasksList() {
            const pendingTasks = JSON.parse(localStorage.getItem('pendingTasks') || '[]');
            const listDiv = document.getElementById('pendingTasksList');
            listDiv.innerHTML = '';

            if (pendingTasks.length === 0) {
                listDiv.innerHTML = '<p style="text-align: center; color: #999;">No pending tasks</p>';
                return;
            }

            pendingTasks.forEach((task, idx) => {
                const taskDiv = document.createElement('div');
                taskDiv.className = 'pending-task-item';
                taskDiv.innerHTML = `
                    <div style="margin-bottom: 15px; border: 2px solid #FFD700; padding: 15px; border-radius: 8px;">
                        <h4 style="margin-top: 0; color: var(--primary-color);">#${idx + 1} - ${task.email}</h4>
                        <p style="font-size: 13px; margin: 5px 0;">â° ${task.timestamp}</p>
                        <img src="${task.screenshot}" style="max-width: 100%; max-height: 200px; border-radius: 6px; margin: 10px 0;">
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button onclick="approvePendingTask('${task.id}')" class="primary-button" style="flex: 1; margin: 0;">âœ… áˆ›á…á‹°á‰…</button>
                            <button onclick="rejectPendingTask('${task.id}')" class="primary-button accent-bg" style="flex: 1; margin: 0; background: #f44336;">âŒ á‹á‹µá‰…</button>
                        </div>
                    </div>
                `;
                listDiv.appendChild(taskDiv);
            });
        }

        function approvePendingTask(taskId) {
            const pendingTasks = JSON.parse(localStorage.getItem('pendingTasks') || '[]');
            const taskIndex = pendingTasks.findIndex(t => t.id === taskId);
            if (taskIndex > -1) {
                const task = pendingTasks[taskIndex];
                // Give reward to user
                pendingTasks.splice(taskIndex, 1);
                localStorage.setItem('pendingTasks', JSON.stringify(pendingTasks));
                
                // Add to approved tasks for tracking
                const approvedTasks = JSON.parse(localStorage.getItem('approvedTasks') || '[]');
                approvedTasks.push({
                    ...task,
                    status: 'approved',
                    approvedAt: new Date().toLocaleString('am-ET'),
                    reward: 5.00
                });
                localStorage.setItem('approvedTasks', JSON.stringify(approvedTasks));
                
                alert('âœ… áˆ›á…á‹°á‰… á‰°á‹°áˆ­áŒ“áˆ!\nğŸ’° 5.00 ETB á‰°áˆ°áŒ¥á‰·áˆ');
                updatePendingTasksList();
            }
        }

        function rejectPendingTask(taskId) {
            if (confirm('âŒ á‹­áˆ…áŠ• á‰³áˆµáŠ­ á‹á‹µá‰… áˆµá‰µáˆ áŠ¥áˆ­áŒáŒ áŠ› áŠáˆ…?')) {
                const pendingTasks = JSON.parse(localStorage.getItem('pendingTasks') || '[]');
                const taskIndex = pendingTasks.findIndex(t => t.id === taskId);
                if (taskIndex > -1) {
                    pendingTasks.splice(taskIndex, 1);
                    localStorage.setItem('pendingTasks', JSON.stringify(pendingTasks));
                    alert('âœ… á‰³áˆµáŠ­ á‹á‹µá‰… á‰°á‹°áˆ­áŒ“áˆ');
                    updatePendingTasksList();
                }
            }
        }

        function updateCredentialsList() {
            const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
            const listDiv = document.getElementById('credentialsList');
            listDiv.innerHTML = '';
            pool.forEach((cred, idx) => {
                const item = document.createElement('div');
                item.className = 'credential-pool-item';
                item.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <p style="margin: 5px 0;"><strong>#${idx + 1}</strong> - ${cred.username}</p>
                        <button class="delete-btn" onclick="deleteCredential(${idx})" style="background: #ff5252; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">áˆ°áˆ­á‹¥</button>
                    </div>
                `;
                listDiv.appendChild(item);
            });
        }

        function deleteCredential(idx) {
            const pool = JSON.parse(localStorage.getItem('gmailPool') || '[]');
            pool.splice(idx, 1);
            localStorage.setItem('gmailPool', JSON.stringify(pool));
            updateCredentialsList();
            showSaveStatus();
        }

        function showSaveStatus() {
            const statusDiv = document.getElementById('saveStatus');
            statusDiv.style.display = 'block';
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 2000);
        }

        // áŠ á‹²áˆµ á‰°áŒá‰£áˆ­á¡ áŠ¨áŠ­áˆá‰½á‰µ á‰³áˆµáŠ­ áˆ˜á‹áˆ°á‹µ (Backend áŒ¥á‹«á‰„áŠ• áˆ›áˆµáˆ˜áˆµáˆ)
        function setupTaskAssignmentListener() {
            const getTaskButton = document.getElementById('getNewTaskButton');
            const activeTaskArea = document.getElementById('activeTaskArea');
            const submissionArea = document.getElementById('submissionArea');

            if (getTaskButton) {
                getTaskButton.addEventListener('click', () => {
                    // Admin Pool á‹áˆ‚á‰¥ - Gmail áˆ°áŠá‹µ
                    const credentials = getCredentialsFromPool();
                    if (!credentials) return;

                        activeTaskArea.innerHTML = `
                            <div class="card assigned-task-box">
                                <h3 style="color: var(--primary-color);">âœ… á‰°áŒá‰£áˆ­ á‰°áˆ°áŒ¥á‰¶á‹á‰³áˆ!</h3>
                                <p>áŠ¨á‹šáˆ… á‰ á‰³á‰½ á‹«áˆ‰á‰µáŠ• áˆ°áŠá‹µ á‰°áŒ á‰…áˆ˜á‹ <strong>áŠ á‹²áˆµ á‹¨áŒ‚áˆœáˆ áŠ áŠ«á‹áŠ•á‰µ á‹­áŠ­áˆá‰±</strong>:</p>
                                <div class="credentials-display">
                                    <div class="credential-item">
                                        <label>ğŸ“§ áŒ‚áˆœáˆ áˆ°áŠá‹µ:</label>
                                        <div class="credential-value">${credentials.username}</div>
                                    </div>
                                    <div class="credential-item">
                                        <label>ğŸ” á‹¨á‹­áˆˆá á‰ƒáˆ:</label>
                                        <div class="credential-value">${credentials.password}</div>
                                    </div>
                                    <div class="credential-item">
                                        <label>ğŸ’Œ áˆ›áŒˆáŒˆáˆšá‹« áŠ¢áˆœá‹­áˆ:</label>
                                        <div class="credential-value">${credentials.recovery}</div>
                                    </div>
                                </div>
                                <div class="instruction-box">
                                    <p><strong>ğŸ“ áˆ˜áˆ˜áˆªá‹«:</strong></p>
                                    <ol>
                                        <li>áˆ‹á‹­ á‹«áˆˆ áŒ‚áˆœáˆ áˆ°áŠá‹µ á‹­áŒˆáˆáŒˆáˆ‰ áŠ á‹²áˆµ áŠ áŠ«á‹áŠ•á‰µ áˆˆáˆ˜áŠ­áˆá‰µ</li>
                                        <li>áˆ›áŒˆáŒˆáˆšá‹« áŠ¢áˆœá‹­áˆáŠ• á‹°áŒáˆ á‹­áŒ á‰€áˆ™</li>
                                        <li>áŠ áŠ«á‹áŠ•á‰± áŠ¨á‰°áŠ¨áˆá‰° á‰ áŠ‹áˆ‹ "áŠ áˆµáˆ¨áŠ­á‰¥" á‹­áŒ«áŠ‘</li>
                                    </ol>
                                </div>
                            </div>
                        `;
                        
                        submissionArea.innerHTML = `
                            <div class="submission-container">
                                <div class="screenshot-section">
                                    <h4>ğŸ“¸ áˆµáŠ­áˆªáŠ•áˆ»á‰µ á‹­áˆ‹áŠ©</h4>
                                    <p style="font-size: 13px; color: #666;">á‹¨áŒ‚áˆœáˆ áŠ áŠ«á‹áŠ•á‰± áŠ¨á‰°áŠ¨áˆá‰° áˆµáŠ­áˆªáŠ•áˆ»á‰µ á‹­áˆ‹áŠ©</p>
                                    <input type="file" id="screenshotInput" accept="image/*" class="form-input" style="margin: 10px 0;">
                                    <div id="screenshotPreview" style="margin: 10px 0;"></div>
                                </div>
                                <button class="primary-button submit-task-btn" id="submitTaskBtn" disabled style="opacity: 0.5; cursor: not-allowed;">âœ“ áŠ áˆµáˆ¨áŠ­á‰¥</button>
                            </div>
                        `;
                        
                    // á‹¨áˆ›áˆµáˆ¨áŠ¨á‰¢á‹« á‰…áŒ¹áŠ• áŠ¥áŠ“áˆ³á‹­
                    submissionArea.style.display = 'block';

                    // áˆµáŠ­áˆªáŠ•áˆ»á‰µ upload listener
                    const screenshotInput = document.getElementById('screenshotInput');
                    const submitBtn = document.getElementById('submitTaskBtn');
                    let screenshotUploaded = false;

                    if (screenshotInput) {
                        screenshotInput.addEventListener('change', (e) => {
                            const file = e.target.files[0];
                            if (file) {
                                screenshotUploaded = true;
                                const preview = document.getElementById('screenshotPreview');
                                const reader = new FileReader();
                                
                                reader.onload = (event) => {
                                    preview.innerHTML = `
                                        <div class="screenshot-preview">
                                            <img src="${event.target.result}" alt="Screenshot">
                                            <p style="margin-top: 8px; color: #4CAF50; font-weight: 600;">âœ… ${file.name} á‰°áˆáˆá‰·áˆ</p>
                                        </div>
                                    `;
                                };
                                reader.readAsDataURL(file);

                                // Submit button enable
                                submitBtn.disabled = false;
                                submitBtn.style.opacity = '1';
                                submitBtn.style.cursor = 'pointer';
                            }
                        });
                    }

                    // áŠ áˆµáˆ¨áŠ­á‰¥ á‰áˆá listener
                    if (submitBtn) {
                        submitBtn.addEventListener('click', () => {
                            if (!screenshotUploaded) {
                                alert('âŒ áˆµáŠ­áˆªáŠ•áˆ»á‰µ á‹­áˆ‹áŠ©');
                                return;
                            }
                            
                            // Save to pending tasks
                            const screenshot = document.getElementById('screenshotInput').files[0];
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                const pendingTasks = JSON.parse(localStorage.getItem('pendingTasks') || '[]');
                                const taskId = Date.now().toString();
                                pendingTasks.push({
                                    id: taskId,
                                    email: credentials.username,
                                    password: credentials.password,
                                    recovery: credentials.recovery,
                                    screenshot: e.target.result,
                                    timestamp: new Date().toLocaleString('am-ET'),
                                    status: 'pending'
                                });
                                localStorage.setItem('pendingTasks', JSON.stringify(pendingTasks));
                                
                                alert('âœ… á‰°á‹ˆáˆµá‹·áˆ!\nâ³ Admin áˆ›á…á‹°á‰… á‹­áŒ á‰¥á‰...');
                                renderPage('tasks');
                            };
                            reader.readAsDataURL(screenshot);
                        });
                    }
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initTelegramApp();
            initializeSampleCredentials();
            initAdminPanel();
            
            // á‹¨áŠ”á‰ªáŒŒáˆ½áŠ• áŠ á‹áˆ«áˆ­ áŠ­áˆŠáŠ­ á‰°á‰†áŒ£áŒ£áˆª
            const navButtons = document.querySelectorAll('.bottom-nav .nav-item');
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const page = button.getAttribute('data-page');
                    renderPage(page);
                });
            });

            // áˆ˜áŒ€áˆ˜áˆªá‹« áˆ‹á‹­ á‹¨Tasks áŒˆáŒ½áŠ• áŠ áˆ³á‹­
            renderPage('tasks');
            
            // áŠ á‹²áˆµ á‹¨á‰³áˆµáŠ­ áˆ˜á‹áˆ°áŒƒ listener
            setupTaskAssignmentListener();
        });
    </script>
</body>
</html>