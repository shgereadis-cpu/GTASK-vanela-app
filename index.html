<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G-Task Manager ­ЪЄф­ЪЄ╣</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="app-container">
        
        <header class="top-header">
            <h1 class="app-title">G-Task Manager</h1>
            <div id="userBalance" class="balance-display">
                <span class="balance-amount">0.00 ETB</span>
            </div>
        </header>

        <main class="content-area" id="contentArea">
            </main>

        <nav class="bottom-nav">
            <button class="nav-item active" data-page="tasks">РюЁ рЅ░рїЇрЅБрѕФрЅх</button>
            <button class="nav-item" data-page="balance">­Ъњ░ рѕѓрѕ│рЅЦ</button>
            <button class="nav-item" data-page="withdraw">­Ъњ│ рѕЏрІЇрїФ</button>
        </nav>
    </div>

    <script>
        // ­ЪџЕ рІѕрѕ│ріЮрЇА рІерЅ┤рѕїрїЇрѕФрѕЮ SDK рѕЏрѕхрїђрѕўрѕфрІФ
        function initTelegramApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
                // рІерЅ┤рѕїрїЇрѕФрѕЮ рїѕрїйрЅ│ рЅђрѕѕрѕЮріЋ ріерібрЅхрІ«рїхрІФрІірІЇ рІ│рѕФ рїІрѕГ рѕѕрѕЏрѕўрѕ│рѕ░рѕЇ
                const bgColor = '#F5F5F5'; 
                window.Telegram.WebApp.setBackgroundColor(bgColor);
            }
        }
        
        // рїѕрїЙрЅйріЋ рІерѕџрЅђрІГрѕГ рЅ░рїЇрЅБрѕГ (рЅаVanilla JS)
        function renderPage(pageName) {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = ''; // рІФрѕѕрІЇріЋ рІГрІўрЅх рЅБрІХ рѕЏрІхрѕерїЇ

            const navItems = document.querySelectorAll('.bottom-nav .nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            document.querySelector(`.nav-item[data-page="${pageName}"]`).classList.add('active');

            let contentHTML = '';

            if (pageName === 'tasks') {
                contentHTML = `
                    <div id="activeTaskArea"></div>
                    <div class="card task-card accent-border">
                        <h2>РюЁ рІерїѓрѕюрѕЇ ріаріФрІЇріЋрЅх рѕўріГрЇѕрЅх</h2>
                        <p>ріарІ▓рѕх рІерїѓрѕюрѕЇ ріаріФрІЇріЋрЅх ріерЇЇрЅ░рІЇ рЅарЅ░рїарЅђрѕ▒рЅх рѕўрѕхрЇѕрѕГрЅХрЅй рѕўрѕарѕерЅх рІФрѕхрѕеріГрЅАрЇб рѕѕріЦрІФріЋрІ│ріЋрІ▒ рЅ░рЅђрЅБрІГріљрЅх рѕІрїѕріў ріаріФрІЇріЋрЅх **5.00 ETB** рІФрїѕріЏрѕЅрЇб</p>
                        <div class="instructions">
                            <h3>рѕўрѕўрѕфрІФрІјрЅй:</h3>
                            <ul>
                                <li>1. ріаріФрІЇріЋрЅ▒ріЋ рѕѕрѕўріГрЇѕрЅх ріарІЮрѕФрѕЕріЋ рІГрїФріЉрЇб</li>
                                <li>2. ріаріФрІЇріЋрЅ▒ ріерЅ░ріерЇѕрЅ░ рЅаріІрѕІ "ріарѕхрѕеріГрЅЦ" рІерѕџрѕѕрІЇріЋ рІГрїФріЉріЊ рібрѕюрІГрѕЅріЋ/рІерІГрѕѕрЇЇ рЅЃрѕЅріЋ рІГрѕІріЕрЇб</li>
                                <li>3. рѕЏрѕерїІрїѕрїФ ріЦрѕхріфрїаріЊрЅђрЅЁ рІГрїарЅЦрЅЂрЇб</li>
                            </ul>
                        </div>
                        <button class="primary-button" id="getNewTaskButton">рїѓрѕюрѕЇ ріаріФрІЇріЋрЅх рІГріГрЇѕрЅ▒</button>
                    </div>
                    <div id="submissionArea" style="display: none;"></div>
                `;
            } else if (pageName === 'balance') {
                 contentHTML = `
                    <div class="card">
                        <h2>­Ъњ░ рІеріЦрѕГрѕхрІј рѕѓрѕ│рЅЦ</h2>
                        <div class="balance-large">
                            <strong>125.00</strong> <small>ETB</small>
                        </div>
                        <p class="history-title">рІерЅЁрѕГрЅЦ рїірІю ріЦріЋрЅЁрѕхрЅЃрѕ┤рІјрЅй:</p>
                        <ul class="history-list">
                            <li>+5.00 ETB (Task #123) - рІЏрѕг</li>
                            <li>-50.00 ETB (рІѕрїф) - рЅхріЊріЋрЅх</li>
                            <li>+10.00 ETB (Task #125) - ріерЅхріЊріЋрЅх рІѕрІ▓рІФ</li>
                        </ul>
                    </div>
                 `;
            } else if (pageName === 'withdraw') {
                 contentHTML = `
                    <div class="card">
                        <h2>­Ъњ│ рїѕріЋрІўрЅЦ рѕЏрІЇрїФ</h2>
                        <p>рїѕріЋрІўрЅЦрІјріЋ рЅарЅ┤рѕї рЅЦрѕГ рІѕрІГрѕЮ рЅарЅБріЋріГ ріаріФрІЇріЋрЅх рѕЏрІЇрїБрЅх рІГрЅйрѕІрѕЅрЇб рІЮрЅЁрЅ░ріЏрІЇ рІерѕЏрІЇрїФ рїѕрІ░рЅЦ **50.00 ETB** ріљрІЇрЇб</p>
                        <input type="number" placeholder="рІерѕЏрІЇрїБрЅх рѕўрїаріЋ рІФрѕхрїѕрЅА (рѕѕрѕЮрѕ│рѕї 50)">
                        <button class="primary-button accent-bg">рѕЏрІЇрїБрЅх рІГрїарІГрЅЂ</button>
                    </div>
                 `;
            }
            contentArea.innerHTML = contentHTML;
        }

        // ­ЪџЕ Gmail рѕ░ріљрІх рѕЏрѕўріЋрїерЅх (рѕџріњріарЇЋ рѕїрѕјрЅй рІЇрѕѓрЅЦ)
        function generateGmailCredentials() {
            const num = Math.floor(Math.random() * 100000);
            const domains = ['gmail.com', 'googlemail.com'];
            const domain = domains[Math.floor(Math.random() * domains.length)];
            const username = `user.task.${num}@${domain}`;
            const password = `Pass${Math.random().toString(36).substr(2, 8).toUpperCase()}${Math.floor(Math.random() * 100)}`;
            const recoveryEmails = ['recovery.001@yahoo.com', 'backup.task@outlook.com', 'alternative.email@mail.com'];
            const recovery = recoveryEmails[Math.floor(Math.random() * recoveryEmails.length)];
            
            return { username, password, recovery };
        }

        // ріарІ▓рѕх рЅ░рїЇрЅБрѕГрЇА ріеріГрѕЮрЅйрЅх рЅ│рѕхріГ рѕўрІЇрѕ░рІх (Backend рїЦрІФрЅёріЋ рѕЏрѕхрѕўрѕхрѕЇ)
        function setupTaskAssignmentListener() {
            const getTaskButton = document.getElementById('getNewTaskButton');
            const activeTaskArea = document.getElementById('activeTaskArea');
            const submissionArea = document.getElementById('submissionArea');

            if (getTaskButton) {
                getTaskButton.addEventListener('click', () => {
                    
                    // рІерЅ┤рѕїрїЇрѕФрѕЮ рѕўрїФріЏріЋ ріЦріЊрѕ│рІГ
                    window.Telegram.WebApp.showProgress('ріарІ▓рѕх рЅ│рѕхріГ ріЦрІерЇѕрѕѕрїѕ ріљрІЇ...');

                    // Backend рїЦрІФрЅё
                    setTimeout(() => {
                        window.Telegram.WebApp.hideProgress();

                        // рѕџріњріарЇЋ рІЇрѕѓрЅЦ - Gmail рѕ░ріљрІх
                        const credentials = generateGmailCredentials();

                        activeTaskArea.innerHTML = `
                            <div class="card assigned-task-box">
                                <h3 style="color: var(--primary-color);">РюЁ рЅ░рїЇрЅБрѕГ рЅ░рѕ░рїЦрЅХрІјрЅ│рѕЇ!</h3>
                                <p>ріерІџрѕЁ рЅарЅ│рЅй рІФрѕЅрЅхріЋ рѕ░ріљрІх рЅ░рїарЅЁрѕўрІЇ <strong>ріарІ▓рѕх рІерїѓрѕюрѕЇ ріаріФрІЇріЋрЅх рІГріГрЇѕрЅ▒</strong>:</p>
                                <div class="credentials-display">
                                    <div class="credential-item">
                                        <label>­ЪЊД рїѓрѕюрѕЇ рѕ░ріљрІх:</label>
                                        <div class="credential-value">${credentials.username}</div>
                                    </div>
                                    <div class="credential-item">
                                        <label>­Ъћљ рІерІГрѕѕрЇЇ рЅЃрѕЇ:</label>
                                        <div class="credential-value">${credentials.password}</div>
                                    </div>
                                    <div class="credential-item">
                                        <label>­Ъњї рѕЏрїѕрїѕрѕџрІФ рібрѕюрІГрѕЇ:</label>
                                        <div class="credential-value">${credentials.recovery}</div>
                                    </div>
                                </div>
                                <div class="instruction-box">
                                    <p><strong>­ЪЊЮ рѕўрѕўрѕфрІФ:</strong></p>
                                    <ol>
                                        <li>рѕІрІГ рІФрѕѕ рїѓрѕюрѕЇ рѕ░ріљрІх рІГрїѕрѕЇрїѕрѕЅ ріарІ▓рѕх ріаріФрІЇріЋрЅх рѕѕрѕўріГрЇѕрЅх</li>
                                        <li>рѕЏрїѕрїѕрѕџрІФ рібрѕюрІГрѕЇріЋ рІ░рїЇрѕъ рІГрїарЅђрѕЎ</li>
                                        <li>ріаріФрІЇріЋрЅ▒ ріерЅ░ріерЇѕрЅ░ рЅаріІрѕІ "ріарѕхрѕеріГрЅЦ" рІГрїФріЉ</li>
                                    </ol>
                                </div>
                            </div>
                        `;
                        
                        submissionArea.innerHTML = `
                            <div class="submission-container">
                                <button class="primary-button submit-task-btn" id="submitTaskBtn">РюЊ ріарѕхрѕеріГрЅЦ</button>
                            </div>
                        `;
                        
                        // рІерѕЏрѕхрѕеріерЅбрІФ рЅЁрї╣ріЋ ріЦріЊрѕ│рІГ
                        submissionArea.style.display = 'block';

                        // ріарѕхрѕеріГрЅЦ рЅЂрѕЇрЇЇ listener
                        const submitBtn = document.getElementById('submitTaskBtn');
                        if (submitBtn) {
                            submitBtn.addEventListener('click', () => {
                                // рІерЅ┤рѕїрїЇрѕФрѕЮ рѕўрїФріЏріЋ ріЦріЊрѕ│рІГ
                                window.Telegram.WebApp.showProgress('рІерѕџрѕхрЅ░ріФріерѕЇ ріљрІЇ...');

                                // Backend рїЦрІФрЅё - рѕѓрѕ│рЅЦ рѕЏрѕхрїѕрЅбрІФ
                                setTimeout(() => {
                                    window.Telegram.WebApp.hideProgress();
                                    alert('РюЁ рЅ░рІѕрѕхрІирѕЇ!\n­Ъњ░ 5.00 ETB рѕѓрѕ│рЅЦрІј рѕІрІГ рЅ│ріГрѕЈрѕЇрЇб');
                                    
                                    // рѕѓрІ░рЅ▒ріЋ рІ│рїЇрѕЮ рїђрѕЮрѕГ
                                    renderPage('tasks');
                                }, 1500);
                            });
                        }
                    
                    }, 2000); // 2 рѕ░ріеріЋрІх рІГрїарЅЦрЅЃрѕЇ
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initTelegramApp();
            
            // рІеріћрЅфрїїрѕйріЋ ріарІЮрѕФрѕГ ріГрѕіріГ рЅ░рЅєрїБрїБрѕф
            const navButtons = document.querySelectorAll('.bottom-nav .nav-item');
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const page = button.getAttribute('data-page');
                    renderPage(page);
                });
            });

            // рѕўрїђрѕўрѕфрІФ рѕІрІГ рІеTasks рїѕрїйріЋ ріарѕ│рІГ
            renderPage('tasks');
            
            // ­ЪџЕ ріарІ▓рѕхрЇА ріарІ▓рѕх рІерЅ│рѕхріГ рѕўрІЇрѕ░рїЃ listener ріЦріЋрїерѕЮрѕФрѕѕріЋ
            setupTaskAssignmentListener();
        });
    </script>
</body>
</html>